(this["webpackJsonpmoss-frontend-challenge"]=this["webpackJsonpmoss-frontend-challenge"]||[]).push([[0],{43:function(e,t,a){},44:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n,s=a(0),i=a.n(s),c=a(12),r=a.n(c),l=a(16),o=a(3),u=a(8),b=a(17),j=a(2),d=Object(s.createContext)(new function e(){var t=this;Object(b.a)(this,e),this.theme="light",this.onlyFavorites=!1,this.isLoading=!0,this.albumsData=[],this.favoriteAlbums=[],this.searchValue="",this.setTheme=function(e){t.theme=e},this.setOnlyFavorites=function(e){t.onlyFavorites=e},this.setIsLoading=function(e){t.isLoading=e},this.setAlbums=function(e){t.albumsData=e},this.setInitialFavorites=function(e){e&&(t.favoriteAlbums=e)},this.setFavoriteAlbums=function(e){if(e){var a=t.favoriteAlbums.filter((function(t){return t.id.label===e.id.label})),n=t.favoriteAlbums;a&&a.length>0?n.forEach((function(e,t){e.id.label===a[0].id.label&&n.splice(t,1)})):(n.push(e),t.favoriteAlbums=n,localStorage.setItem("@myfav:albums",JSON.stringify(t.favoriteAlbums)))}},this.setSearchValue=function(e){t.searchValue=e},Object(j.l)(this)}),h=a(80),m=a(78),f=a(77),v=a(18),O=(a(43),a(44),a(1)),x=Object(u.a)((function(e){var t=e.album,a=Object(s.useContext)(d),n=a.favoriteAlbums,i=a.setFavoriteAlbums,c=n.filter((function(e){return e.id.label===(null===t||void 0===t?void 0:t.id.label)})),r=!!(c&&c.length>0);return Object(O.jsx)("button",{className:"favorite-button",onClick:function(){return i(t)},children:r?Object(O.jsx)(f.a,{className:"favorite-button__svg--active"}):Object(O.jsx)(m.a,{className:"favorite-button__svg"})})})),p=function(e){var t=e.album,a=Object(o.f)();return Object(O.jsxs)("div",{className:"album-card",children:[Object(O.jsx)("figure",{className:"album-card__image",children:Object(O.jsx)(v.LazyLoadImage,{alt:"".concat(t["im:name"].label," cover"),effect:"blur",src:t["im:image"][2].label})}),Object(O.jsxs)("div",{className:"album-card__info",children:[Object(O.jsx)("div",{className:"info__favorite",children:Object(O.jsx)(x,{album:t})}),Object(O.jsxs)("div",{className:"info__name",children:[Object(O.jsx)("p",{children:t["im:name"].label}),Object(O.jsx)("span",{children:t["im:artist"].label})]}),Object(O.jsxs)("div",{className:"info__price",children:[Object(O.jsx)("button",{onClick:function(){return a.push("/album-detail/".concat(t.id.attributes["im:id"]))},children:"Show details"}),Object(O.jsx)("span",{children:t["im:price"].label})]})]})]})},g=(a(50),a(14)),_=a(79),w=(a(51),Object(u.a)((function(){var e=Object(s.useContext)(d),t=e.searchValue,a=e.setSearchValue,n=Object(s.useState)(!1),i=Object(g.a)(n,2),c=i[0],r=i[1];return Object(O.jsxs)("div",{className:"search-input ".concat(c&&"search-input--focused"),children:[Object(O.jsx)("span",{className:"search-input__placeholder",children:"Search by artist or album"}),Object(O.jsx)("input",{type:"text",value:t,onFocus:function(){return r(!0)},onBlur:function(){return!t&&r(!1)},onChange:function(e){var t=e.target.value;return a(t)}}),Object(O.jsx)(_.a,{})]})}))),N=Object(u.a)((function(){var e=Object(s.useContext)(d),t=e.albumsData,a=e.isLoading,n=e.searchValue,i=e.favoriteAlbums,c=e.onlyFavorites,r=e.setOnlyFavorites,l=null===t||void 0===t?void 0:t.filter((function(e){return e["im:artist"].label.toLowerCase().includes(n.toLowerCase())||e["im:name"].label.toLowerCase().includes(n.toLowerCase())})),o=i.filter((function(e){return e["im:artist"].label.toLowerCase().includes(n.toLowerCase())||e["im:name"].label.toLowerCase().includes(n.toLowerCase())}));return Object(O.jsxs)("div",{className:"home-view",children:[Object(O.jsx)("div",{className:"home-view__title",children:Object(O.jsx)("h1",{children:"The BEST of ITunes"})}),Object(O.jsxs)("div",{className:"home-view__search-input",children:[Object(O.jsx)(w,{}),Object(O.jsxs)("div",{className:"show-only-favorites",children:[Object(O.jsx)("button",{onClick:function(){return r(!c)},children:c?"Back to general list":"Show Favorites"}),!c&&Object(O.jsx)(f.a,{})]})]}),Object(O.jsx)("div",{className:"home-view__albums-list",children:c?o&&o.length>0?o.map((function(e){return Object(O.jsx)(p,{album:e},e.id.label)})):Object(O.jsxs)("p",{children:["Looks like you dont have favs yet. Try touching some ",Object(O.jsx)(m.a,{}),"`s"]}):a?Object(O.jsx)(h.a,{}):l&&l.length>0?l.map((function(e){return Object(O.jsx)(p,{album:e},e.id.label)})):Object(O.jsx)("p",{children:"Ops! There is no such artist or album in this list"})})]})})),y=a(38);!function(e){e.music="music",e.musicVideo="musicVideo",e.movie="movie",e.podcast="podcast",e.audiobook="audiobook",e.shortFilm="shortFilm",e.tvShow="tvShow",e.software="software",e.ebook="ebook",e.all="all"}(n||(n={}));a(52);var k=a(15),C=a.n(k),L=a(24),S=a(25),A=a.n(S),F=function e(){Object(b.a)(this,e)};F.getAlbuns=Object(L.a)(C.a.mark((function e(){var t,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.a.get("https://itunes.apple.com/us/rss/topalbums/limit=100/json");case 3:return t=e.sent,a=t.data.feed,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),F.getSearchResults=function(){var e=Object(L.a)(C.a.mark((function e(t,a){var n,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.a.post("https://itunes.apple.com/search?term=".concat(t,"&media=").concat(a));case 3:return n=e.sent,s=n.data.results,e.abrupt("return",s);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}();a(72);var I=function(e){var t=e.trackName,a=e.previewUrl;return Object(O.jsxs)("div",{className:"audio-card",children:[Object(O.jsx)("p",{children:t}),Object(O.jsx)("audio",{src:a,controls:!0})]})},T=Object(u.a)((function(){var e=Object(o.g)().album_id,t=Object(o.f)(),a=Object(s.useContext)(d),i=a.albumsData,c=a.isLoading,r=a.setIsLoading,l=Object(s.useState)(),u=Object(g.a)(l,2),b=u[0],j=u[1],m=Object(s.useState)(),f=Object(g.a)(m,2),p=f[0],_=f[1];Object(s.useEffect)((function(){if(r(!0),i&&i.length>0){var t=i.filter((function(t){return t.id.attributes["im:id"]===e}));j(t[0]),F.getSearchResults(t[0].title.label,n.music).then((function(e){e&&_(e)})).finally((function(){return r(!1)}))}}),[e,i,r]);return Object(O.jsx)("div",{className:"album-detail",children:c?Object(O.jsx)(h.a,{}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(v.LazyLoadComponent,{children:Object(O.jsx)("div",{className:"album-detail__cover",style:{backgroundImage:"url(".concat(null===b||void 0===b?void 0:b["im:image"][2].label,")")},children:Object(O.jsx)("button",{className:"cover__back-btn",onClick:function(){return t.goBack()},children:Object(O.jsx)(y.a,{})})})}),Object(O.jsxs)("div",{className:"album-detail__title",children:[Object(O.jsx)("h1",{children:null===b||void 0===b?void 0:b["im:name"].label}),Object(O.jsx)(x,{album:b})]}),Object(O.jsx)("div",{className:"album-detail__info",children:Object(O.jsxs)("ul",{children:[Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:"Artist: "}),null===b||void 0===b?void 0:b["im:artist"].label]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:"Category: "}),null===b||void 0===b?void 0:b.category.attributes.label]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:"Price: "}),null===b||void 0===b?void 0:b["im:price"].label]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:"Release Date: "}),null===b||void 0===b?void 0:b["im:releaseDate"].attributes.label]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:"ITunes page: "}),Object(O.jsx)("a",{href:null===b||void 0===b?void 0:b.link.attributes.href,target:"_blank",rel:"noreferrer",children:"Click Here"})]})]})}),Object(O.jsxs)("div",{className:"album-detail__media",children:[Object(O.jsxs)("p",{children:["More of ",Object(O.jsx)("span",{children:null===b||void 0===b?void 0:b.title.label})," on ITunes"]}),Object(O.jsx)("div",{className:"media__list",children:c?Object(O.jsx)(h.a,{}):p&&p.length>0?null===p||void 0===p?void 0:p.map((function(e){return Object(O.jsx)(I,{previewUrl:e.previewUrl,trackName:e.trackName},e.artistId)})):Object(O.jsx)("p",{children:"Sorry, we couldn`t find anything related :( "})})]})]})})})),V=(a(73),Object(u.a)((function(e){var t=e.children,a=Object(s.useContext)(d);return Object(O.jsx)("div",{className:"page-container page-container--".concat(a.theme),children:t})}))),D=Object(u.a)((function(){var e=Object(s.useContext)(d),t=e.albumsData,a=e.setAlbums,n=e.setIsLoading,i=e.setInitialFavorites,c=localStorage.getItem("@myfav:albums");return Object(s.useEffect)((function(){if((!t||t.length<1)&&F.getAlbuns().then((function(e){e&&a(e.entry)})).finally((function(){return n(!1)})),c){var e=JSON.parse(c);e.length>0&&i(e)}}),[t,a,n,i,c]),Object(O.jsx)(l.a,{basename:"/moss-frontend-challenge",children:Object(O.jsx)(V,{children:Object(O.jsxs)(o.c,{children:[Object(O.jsx)(o.a,{path:"/",exact:!0,component:N}),Object(O.jsx)(o.a,{path:"/album-detail/:album_id",exact:!0,component:T})]})})})}));var B=function(){return Object(O.jsx)(D,{})};a(74);r.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(B,{})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.fa41d21f.chunk.js.map